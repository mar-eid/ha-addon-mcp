 ğŸ› ï¸ Home Assistant MCP Server Add-on

[![Build & Push](https://github.com/mar-eid/ha-addon-mcp/actions/workflows/build.yml/badge.svg)](https://github.com/mar-eid/ha-addon-mcp/actions/workflows/build.yml)

En [Home Assistant](https://www.home-assistant.io/) add-on som kjÃ¸rer en **Model Context Protocol (MCP) server**.
Serveren kobler seg til den lokale PostgreSQL/TimescaleDB-instansen (Recorder) og eksponerer historiske data og statistikk for **Home Assistant Assist** via MCP-klienten.

---

## âœ¨ Funksjoner
- ğŸšª **Ingress**: Ã…pnes direkte i Home Assistant-grensesnittet, ingen porter eller egen innlogging nÃ¸dvendig.
- ğŸ“Š **Historikk og statistikk**: Hent enkel tidsserie eller batch-statistikk for flere entiteter.
- ğŸ”’ **Read-only-modus**: Beskytter databasen mot skriving.
- â±ï¸ **TimescaleDB toggle**: Mulighet for Ã¥ aktivere Timescale-funksjoner nÃ¥r det er stÃ¸ttet.
- ğŸ”„ **Auto-oppdateringer**: Integrert med Home Assistant Add-on Store â€“ bump `version` i `config.json` og HA henter nyeste image.

---

## ğŸ“¦ Installasjon

1. Ã…pne **Add-on Store** i Home Assistant.
2. Klikk pÃ¥ â‹®-menyen â†’ **Repositories**.
3. Legg til dette repoet:
https://github.com/mar-eid/ha-addon-mcp

4. Installer **MCP Server** fra listen.
5. Start add-on, Ã¥pne **Web UI** (Ingress).

## âš™ï¸ Konfigurasjon

`config.json` definerer fÃ¸lgende alternativer:

pg_host: 127.0.0.1        # Database host (som regel localhost)
pg_port: 5432             # PostgreSQL port
pg_database: homeassistant
pg_user: ha_read
pg_password: ""           # Valgfritt
read_only: true           # true = kun SELECT
enable_timescaledb: false # SlÃ¥ pÃ¥ TimescaleDB-utvidelse
ğŸ§° Tilgjengelige MCP-tools
ha.get_history â†’ hent enkel tidsserie (nedprÃ¸vet intervall, f.eks. 5m/1h)

ha.get_statistics â†’ aggregert statistikk (hour/day)

ha.get_statistics_bulk â†’ batch-statistikk for flere serier

ha.statistics_meta â†’ oversikt over tilgjengelige serier og felter

addon.health â†’ status for server og DB-tilkobling

ğŸ›¡ï¸ Sikkerhet
Read-only DB-bruker anbefales.

read_only: true tvinger alle queries til Ã¥ vÃ¦re SELECT.

enable_timescaledb: false med mindre du har full kontroll pÃ¥ databasen.

ğŸš€ Utvikling
Bygg image lokalt
bash
Kopier kode
docker build -t ha-addon-mcp ./mcp-server
KjÃ¸r container lokalt
bash
Kopier kode
docker run --rm -it -p 8099:8099 ha-addon-mcp
GitHub Actions
Repoet inkluderer en workflow (.github/workflows/build.yml) som:

bygger for amd64 og arm64

pusher til GitHub Container Registry (ghcr.io/mar-eid/ha-addon-mcp-{arch})

ğŸ“œ Changelog
Se CHANGELOG.md.

ğŸ¤ Bidra
Pull requests og issues er velkomne!
Har du forslag til nye MCP-tools eller forbedringer, lag en issue eller PR.

ğŸ“„ Lisens
Dette prosjektet er lisensiert under MIT.


---

Vil du at jeg ogsÃ¥ legger til en **fin logo/banner**-seksjon Ã¸verst (f.eks. Home Assistant-ikon + MCP-ser